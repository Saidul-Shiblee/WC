<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="style.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    
    <title>Wash & Clean </title>
</head>
<body>
    <div class="flex items-center justify-center h-screen bg-cover" style="background-image: url(../assets/login.jpg)">
        <form id='userForm' action="" class="bg-gray-600 border-0 rounded-lg py-6 px-10 shadow-2xl bg-opacity-90 " onsubmit="return false" >
          <div class="flex flex-col items-center justify-center">  
            <div class="flex justify-center">
                <h1 class=" text-white text-3xl font-bold">Member Registration</h1>
            </div>
            <div class="flex flex-col items-center justify-center" id="err">

             
            </div>

             <div class='flex relative  h-10 mt-6 justify-center'>
                <input id="name" class='w-full h-10 border-0 pl-8 pr-3 focus:ring-blue-800 focus:outline-none focus:ring-2 '  type="text" placeholder="User Name"  >   
                <div class="bg-white w-auto h-10  px-2 absolute left-0 inset-y-0 flex justify-center items-center"><i class="fas fa-user "></i></div>
             </div>

             <div class='flex relative  h-10 mt-6 justify-center'>
                <input id="email" class='w-full h-10 border-0 pl-8 pr-3 focus:ring-blue-800 focus:outline-none focus:ring-2 '  type="email" placeholder="E-mail"  >   
                <div class="bg-white w-auto h-10  px-2 absolute left-0 inset-y-0 flex justify-center items-center"><i class="fas fa-envelope"></i></div>
             </div>

             <div class='flex relative  h-10 mt-6 justify-center'>
                <input id="mobile" class='w-full h-10 border-0 pl-8 pr-3 focus:ring-blue-800 focus:outline-none focus:ring-2 '  type="text" placeholder="+8801711000111"  placeholder="">   
                <div class="bg-white w-auto h-10  px-2 absolute left-0 inset-y-0 flex justify-center items-center"><i class="fas fa-mobile-alt"></i></div>
             </div>

             <div class='flex relative  h-10 mt-6 justify-center'>
                <input id="password" class='w-full h-10 border-0 pl-8 pr-3 focus:ring-blue-800 focus:outline-none focus:ring-2 ' type="Password" placeholder="Password"  >   
                <div class="bg-white w-auto h-10  px-2 absolute left-0 inset-y-0 flex justify-center items-center"><i class="fas fa-lock "></i></div>
             </div>
             <div class='flex relative  h-10 mt-6 justify-center'>
                <input id="re_password" class='w-full h-10 border-0 pl-8 pr-3 focus:ring-blue-800 focus:outline-none focus:ring-2 ' placeholder="Re Enter Password" type="Password" >   
                <div class="bg-white w-auto h-10  px-2 absolute left-0 inset-y-0 flex justify-center items-center"><i class="fas fa-lock "></i></div>
             </div>
             <div class=' flex justify-center mt-6'>
               <button onClick='createUser()' class=" w-full h-auto p-2  bg-owngreen ">Sign Up</button>
             </div>

             <div class ="p-2 flex justify-center mt-6">
                 <p class=" text-white">Already registered?, please click <a class="text-blue-900 underline" href="Signin.html"> here </a>  </p> 
             </div>
            </div> 
        </form>
      
        
    </div>



    <script type="text/javascript"> 
        function createUser(){
            const userName=document.querySelector('#name').value
            const eMail=document.querySelector('#email').value
            const mobile=document.querySelector('#mobile').value
            const password=document.querySelector('#password').value
            const rePassword=document.querySelector('#re_password').value
            const userForm= document.querySelector('#userForm')
            const err=document.querySelector('#err')
            Users= JSON.parse(localStorage.getItem('Users'))?JSON.parse(localStorage.getItem('Users')):[]
            let errors=formValidation(userName,eMail,mobile,password,rePassword,Users)
            let errorList=Object.values(errors)
            errorMessage=""
            if(errorList.some(error => error !=="")){
                errorMessage +=`
                ${errorList.map((el)=>`<p class="text-red-300 text-xs">${el}</P>`).join('\n')}    
                `
                err.innerHTML=errorMessage
            }else{
                Users.push({'name':userName,
                      'email':eMail,
                      'password':password,
                      'role':'member'
                     })
                localStorage.setItem('Users',JSON.stringify(Users));
                userForm.reset();  
                alert('Sign Up successfull') 
                window.location.href = "signin.html"; 
            }
    }
    
    //form Validator function
    function formValidation(userName,eMail,mobile,password,rePassword){
        let error={}

        //function to validate user name

        function checkuserName(){
            if(!userName){
                error.userName ="User name can not be left blank"
            }else{
                if(!userName.match(/^[0-9a-z]+$/i)){
                    error.userName ="Name should Not have any special Character"
                }else{
                    error.userName=""
                }
            }
        }    
        //function to validate eMail
        function checkeMail(){
            if(!eMail){
                error.eMail ="E-mail can not be left blank"
            }else{
                if(!eMail.match(/(\S+@\S+\.\S+)/)){
                    error.eMail ="Please Enter a Valid E-mail"
                }else{
                    error.eMail=""
                }
            }
        }
       //function to validate Mobile No.
        function checkeMobile(){
            if(!mobile){
                error.mobile ="Mobile No. can not be left blank"
            }else{
                if(!mobile.match(/^\+?(\+[88]{2})\)??(\d{11})?/)){
                    error.mobile ="Please Enter Mobile in correct format"
                }else{
                    error.mobile=""
                }
            }
        }
        //function to validate Password
        function checkPassword(){
            if(!password){
                error.password ="Password can not be left blank"
            }else{
                if(!password.match(/^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,16}$/)){
                    error.password =" Password At least 6 Characters,must have 1 No. & 1 Special Character"
                }else if(password!=rePassword){
                    error.password ="Password is not matched"
                }else{
                    error.password=""
                }
            }
        }
        //function to check the existance of user
        function checkuserExistance(){
            if(Users.some(user=>user.email==eMail)){
                error.userExistance="Email already registered"
            }else{
                error.userExistance=""
            }
        }
        checkuserName();
        checkeMail();
        checkeMobile();
        checkPassword();
        checkuserExistance();
        return error;
    }

    </script>
</body>

</html>